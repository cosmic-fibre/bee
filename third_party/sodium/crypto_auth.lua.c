const char crypto_auth_lua[] =
"local ffi = require \"ffi\"\n"
"local lib = ffi.load \"sodium\"\n"
"\n"
"ffi.cdef [[\n"
"size_t crypto_auth_hmacsha512256_bytes(void);\n"
"size_t crypto_auth_hmacsha512256_keybytes(void);\n"
"const char * crypto_auth_hmacsha512256_primitive(void);\n"
"int crypto_auth_hmacsha512256(unsigned char *,const unsigned char *,unsigned long long,const unsigned char *);\n"
"int crypto_auth_hmacsha512256_verify(const unsigned char *,const unsigned char *,unsigned long long,const unsigned char *);\n"
"size_t crypto_auth_bytes(void);\n"
"size_t crypto_auth_keybytes(void);\n"
"const char *crypto_auth_primitive(void);\n"
"int crypto_auth(unsigned char *out, const unsigned char *in,\n"
"                unsigned long long inlen, const unsigned char *k);\n"
"int crypto_auth_verify(const unsigned char *h, const unsigned char *in,\n"
"                       unsigned long long inlen, const unsigned char *k);\n"
"size_t crypto_auth_hmacsha256_bytes(void);\n"
"size_t crypto_auth_hmacsha256_keybytes(void);\n"
"const char * crypto_auth_hmacsha256_primitive(void);\n"
"int crypto_auth_hmacsha256(unsigned char *,const unsigned char *,unsigned long long,const unsigned char *);\n"
"int crypto_auth_hmacsha256_verify(const unsigned char *,const unsigned char *,unsigned long long,const unsigned char *);\n"
"]]\n"
"\n"
"local _M = { }\n"
"\n"
"_M.bytes = function() return tonumber(lib.crypto_auth_bytes()) end\n"
"_M.keybytes = function() return tonumber(lib.crypto_auth_keybytes()) end\n"
"_M.primitive = function() return ffi.string(lib.crypto_auth_primitive()) end\n"
"_M.auth = function(out, inbuff, inlen, key) \n"
"\tlocal outlen = _M.bytes()\n"
"\tout = out or ffi.new(\"unsigned char[?]\", outlen)\n"
"\tassert(lib.crypto_auth(out, inbuff, inlen or #inbuff, key) == 0, \"crypto_auth returned non-zero\")\n"
"\treturn out, outlen\n"
"end\n"
"_M.verify = function(h, inbuff, inlen, key)\n"
"\treturn lib.crypto_auth_verify(h, inbuff, inlen or #inbuff, key) == 0\n"
"end\n"
"\n"
"return setmetatable ( _M , { __call = function(_M, ...) return _M.auth(...) end } )\n"
""
;
