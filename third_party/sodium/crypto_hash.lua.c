const char crypto_hash_lua[] =
"local ffi = require \"ffi\"\n"
"local lib = ffi.load \"sodium\"\n"
"\n"
"ffi.cdef [[\n"
"size_t crypto_hash_sha512_bytes(void);\n"
"const char * crypto_hash_sha512_primitive(void);\n"
"int crypto_hash_sha512(unsigned char *,const unsigned char *,unsigned long long);\n"
"int crypto_hash(unsigned char *out, const unsigned char *in,\n"
"                unsigned long long inlen);\n"
"size_t crypto_hash_sha256_bytes(void);\n"
"const char * crypto_hash_sha256_primitive(void);\n"
"int crypto_hash_sha256(unsigned char *,const unsigned char *,unsigned long long);\n"
"]]\n"
"\n"
"local _M = { }\n"
"\n"
"_M.hash = lib.crypto_hash\n"
"\n"
"return setmetatable ( _M , { __call = function(_M, ...) return _M.hash(...) end } )\n"
"\n"
""
;
