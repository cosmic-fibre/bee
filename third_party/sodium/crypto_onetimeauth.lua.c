const char crypto_onetimeauth_lua[] =
"local ffi = require \"ffi\"\n"
"local lib = ffi.load \"sodium\"\n"
"\n"
"ffi.cdef [[\n"
"typedef struct crypto_onetimeauth_poly1305_implementation {\n"
"    const char *(*implementation_name)(void);\n"
"    int (*onetimeauth)(unsigned char *out,\n"
"                               const unsigned char *in,\n"
"                               unsigned long long inlen,\n"
"                               const unsigned char *k);\n"
"    int (*onetimeauth_verify)(const unsigned char *h,\n"
"                                      const unsigned char *in,\n"
"                                      unsigned long long inlen,\n"
"                                      const unsigned char *k);\n"
"} crypto_onetimeauth_poly1305_implementation;\n"
"size_t crypto_onetimeauth_poly1305_bytes(void);\n"
"size_t crypto_onetimeauth_poly1305_keybytes(void);\n"
"const char * crypto_onetimeauth_poly1305_primitive(void);\n"
"const char *crypto_onetimeauth_poly1305_implementation_name(void);\n"
"int crypto_onetimeauth_poly1305_set_implementation(crypto_onetimeauth_poly1305_implementation *impl);\n"
"crypto_onetimeauth_poly1305_implementation *\n"
"        crypto_onetimeauth_pick_best_implementation(void);\n"
"int crypto_onetimeauth_poly1305(unsigned char *out,\n"
"                                const unsigned char *in,\n"
"                                unsigned long long inlen,\n"
"                                const unsigned char *k);\n"
"int crypto_onetimeauth_poly1305_verify(const unsigned char *h,\n"
"                                       const unsigned char *in,\n"
"                                       unsigned long long inlen,\n"
"                                       const unsigned char *k);\n"
"size_t crypto_onetimeauth_bytes(void);\n"
"size_t crypto_onetimeauth_keybytes(void);\n"
"const char *crypto_onetimeauth_primitive(void);\n"
"int crypto_onetimeauth(unsigned char *out, const unsigned char *in,\n"
"                       unsigned long long inlen, const unsigned char *k);\n"
"int crypto_onetimeauth_verify(const unsigned char *h, const unsigned char *in,\n"
"                              unsigned long long inlen, const unsigned char *k);\n"
"]]\n"
"\n"
"local _M = { }\n"
"\n"
"_M.bytes = function() return tonumber(lib.crypto_onetimeauth_bytes()) end\n"
"_M.keybytes = function() return tonumber(lib.crypto_onetimeauth_keybytes()) end\n"
"_M.primitive = function() return ffi.string(lib.crypto_onetimeauth_primitive()) end\n"
"_M.onetimeauth = function(a,m,mlen,k)\n"
"\ta = a or ffi.new(\"unsigned char[?]\", _M.bytes())\n"
"\tmlen = mlen or #m\n"
"\tassert(lib.crypto_onetimeauth(a,m,mlen,k) == 0, \"crypto_onetimeauth returned non-zero\")\n"
"\treturn a\n"
"end\n"
"_M.verify = function(a,m,mlen,k)\n"
"\tmlen = mlen or #m\n"
"\treturn lib.crypto_onetimeauth_verify(a,m,mlen,k) == 0\n"
"end\n"
"\n"
"return setmetatable ( _M , { __call = function(_M, ...) return _M.onetimeauth(...) end } )\n"
""
;
